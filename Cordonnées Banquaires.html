<!DOCTYPE html>
<html lang="">
<head>
  <title>TKT</title>
  <script>
    function formatPhoneNumber() {
      let phoneInput = document.getElementById('telephone');
      let formattedPhone = phoneInput.value.replace(/\D/g, '');
      let formattedPhoneWithSpaces = '';
      for (let i = 0; i < formattedPhone.length; i++) {
        if (i%2 === 0 && i !== 0) {
          formattedPhoneWithSpaces += ' ';
        }
        formattedPhoneWithSpaces += formattedPhone[i];
      }
      phoneInput.value = formattedPhoneWithSpaces;
    }
    function addSpacesToCreditCardNumber(input) {

      var value = input.value.replace(/\s/g, '');


      var newValue = '';
      for (var i = 0; i < value.length; i++) {
        if (i % 4 === 0 && i > 0) {
          newValue = newValue.concat(' ');
        }
        newValue = newValue.concat(value.charAt(i));
      }


      input.value = newValue;


      if (newValue.length === 19) {

        document.getElementById("expiration").focus();
      }
    }

    function addSlashAfterMonth(input) {
      if (input.value.length === 2 && !input.value.includes('/')) {
        input.value += '/';
      document.getElementById("expiration").addEventListener("input", function() {
        if (this.value.length === 5) {
          document.getElementById("cvv").focus();
        }
        });
      }
    }

    function validateExpirationDate(input) {
      var today = new Date();
      var currentMonth = today.getMonth() + 1;
      var currentYear = today.getFullYear().toString().substr(-2);

      var inputMonth = parseInt(input.value.substr(0, 2));
      var inputYear = parseInt(input.value.substr(3, 2));

      if (inputYear < currentYear || (inputYear == currentYear && inputMonth < currentMonth)) {
        input.setCustomValidity("La date d'expiration doit être ultérieure à la date actuelle.");
      } else {
        input.setCustomValidity("");
      }
    }




  </script>
</head>
<body>
<h1>Formulaire de commande</h1><br>
<h4>En France uniquement</h4><br><br>
<form method="GET de livraison</h2><br>
  <label for="nom">Nom :</label>
  <input type="text" id="nom" name="nom" pattern="[A-Za-zÀ-ÿ\s]+" required><br><br>
  <label for="prénom">Prénom :</label>
  <input type="text" id="prénom" name="prénom" pattern="[A-Za-zÀ-ÿ\s]+" required><br><br>
  <label for="email">Email :</label>
  <input type="email" id="email" name="email" pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}" required><br><br>
  <label for="telephone">Téléphone :</label>
  <input type="tel" id="telephone" name="telephone" pattern="0[1-9]([-\s]?[0-9]{2}){4}" oninput="formatPhoneNumber()" required><br><br>
  <label for="adresse">Adresse :</label>
  <input type="text" id="adresse" name="adresse" required><br><br>
  <label for="code_postal">Code postal :</label>
  <input type="text" id="code_postal" name="code_postal" pattern="[0-9]{5}" required><br><br>
  <h2>Informations de payement</h2><br>
  <label for="carte_credit">Numéro de carte de crédit :</label>
  <input type="text" id="carte_credit" name="carte_credit" pattern="\d{4}[\s\-]?\d{4}[\s\-]?\d{4}[\s\-]?\d{4}" oninput="addSpacesToCreditCardNumber(this)" required><br><br>
  <label for="expiration">Date d'expiration (MM/AA) :</label>
  <input type="text" id="expiration" name="expiration" pattern="(0[1-9]|1[0-2])\/([0-9]{2})" required oninput="addSlashAfterMonth(this) ; validateExpirationDate(this)" ><br><br>
  <label for="cvv">Code de sécurité CVV :</label>
  <input type="text" id="cvv" name="cvv" pattern="[0-9]{3}" required><br><br><br><br>
  <input type="submit" value="REçEVOIR VOTRE PROD0uIT">
</form>
<br><br><p><strong>Toutes les informations à remplir ici sont obligatoires</strong></p>
</body>
</html>
